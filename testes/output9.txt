-- OPERAÇÕES CONTEMPLADAS PELO CASO DE TESTE:
-- CADASTRO DE JOGO
-- CADASTRO DE CATEGORIA
-- LISTAGEM DE JOGOS POR CATEGORIA
-- IMPRIMIR ARQUIVO JOGOS
-- IMPRIMIR ÍNDICE DE JOGOS
-- IMPRIMIR ÍNDICE DE TITULO
-- IMPRIMIR ÍNDICE DE DATA
-- IMPRIMIR ÍNDICE DE CATEGORIAS

-- jogo A
INSERT INTO jogos VALUES ('Meia-Vida', 'Valvula', 'Valvula', '19981119', 29.69);
OK

-- jogo B
INSERT INTO jogos VALUES ('Presa', 'Cabeca de Melao Studios', '40K Jogos', '20070711', 44.29);
OK

-- jogo C
INSERT INTO jogos VALUES ('Catorze Minutos', 'Antonio Luis', 'Annapurr', '20210819', 51.99);
OK

-- jogo D, mesma desenvolvedora do jogo A
INSERT INTO jogos VALUES ('Esquerda 4 Morto 2', 'Valvula', 'Valvula', '20091117', 20.69);
OK

-- jogo E
INSERT INTO jogos VALUES ('Cavaleiro Vazio', 'Time Cereja', 'Time Cereja', '20170224', 27.99);
OK

-- jogo F
INSERT INTO jogos VALUES ('Katana -1', 'Askiihard', 'Retornar Analogo', '20190418', 28.99);
OK

-- jogo G
INSERT INTO jogos VALUES ('Overtale', 'Tobias Raposa', 'Tobias Raposa', '20190418', 19.99);
OK

-- jogo H
INSERT INTO jogos VALUES ('Pluto', 'Supertiny Games', 'Supertiny Games', '20200917', 47.49);
OK

-- jogo I
INSERT INTO jogos VALUES ('After Your Eyes', 'HelloWorld Games', 'Groundbound Games', '20210408', 20.69);
OK

\echo file ARQUIVO_JOGOS
00000000;Meia-Vida;Valvula;Valvula;19981119;0000000029.69;;#####################################################################################################################################################################################################00000001;Presa;Cabeca de Melao Studios;40K Jogos;20070711;0000000044.29;;#######################################################################################################################################################################################00000002;Catorze Minutos;Antonio Luis;Annapurr;20210819;0000000051.99;;#########################################################################################################################################################################################00000003;Esquerda 4 Morto 2;Valvula;Valvula;20091117;0000000020.69;;############################################################################################################################################################################################00000004;Cavaleiro Vazio;Time Cereja;Time Cereja;20170224;0000000027.99;;#######################################################################################################################################################################################00000005;Katana -1;Askiihard;Retornar Analogo;20190418;0000000028.99;;##########################################################################################################################################################################################00000006;Overtale;Tobias Raposa;Tobias Raposa;20190418;0000000019.99;;##########################################################################################################################################################################################00000007;Pluto;Supertiny Games;Supertiny Games;20200917;0000000047.49;;#########################################################################################################################################################################################00000008;After Your Eyes;HelloWorld Games;Groundbound Games;20210408;0000000020.69;;############################################################################################################################################################################
\echo index jogos_idx
00000000, 0
00000001, 1
00000002, 2
00000003, 3
00000004, 4
00000005, 5
00000006, 6
00000007, 7
00000008, 8
\echo index titulo_idx
After Your Eyes, 00000008
Catorze Minutos, 00000002
Cavaleiro Vazio, 00000004
Esquerda 4 Morto 2, 00000003
Katana -1, 00000005
Meia-Vida, 00000000
Overtale, 00000006
Pluto, 00000007
Presa, 00000001

-- cadastrar categorias para jogos existentes
UPDATE jogos SET categorias = array_append(categorias, 'FPS') WHERE titulo = 'Meia-Vida';
OK
\echo file ARQUIVO_JOGOS
00000000;Meia-Vida;Valvula;Valvula;19981119;0000000029.69;FPS;##################################################################################################################################################################################################00000001;Presa;Cabeca de Melao Studios;40K Jogos;20070711;0000000044.29;;#######################################################################################################################################################################################00000002;Catorze Minutos;Antonio Luis;Annapurr;20210819;0000000051.99;;#########################################################################################################################################################################################00000003;Esquerda 4 Morto 2;Valvula;Valvula;20091117;0000000020.69;;############################################################################################################################################################################################00000004;Cavaleiro Vazio;Time Cereja;Time Cereja;20170224;0000000027.99;;#######################################################################################################################################################################################00000005;Katana -1;Askiihard;Retornar Analogo;20190418;0000000028.99;;##########################################################################################################################################################################################00000006;Overtale;Tobias Raposa;Tobias Raposa;20190418;0000000019.99;;##########################################################################################################################################################################################00000007;Pluto;Supertiny Games;Supertiny Games;20200917;0000000047.49;;#########################################################################################################################################################################################00000008;After Your Eyes;HelloWorld Games;Groundbound Games;20210408;0000000020.69;;############################################################################################################################################################################
\echo index categorias_secundario_idx
FPS, 0
\echo index categorias_primario_idx
00000000, -1

UPDATE jogos SET categorias = array_append(categorias, 'Metroidvania') WHERE titulo = 'Cavaleiro Vazio';
OK
\echo file ARQUIVO_JOGOS
00000000;Meia-Vida;Valvula;Valvula;19981119;0000000029.69;FPS;##################################################################################################################################################################################################00000001;Presa;Cabeca de Melao Studios;40K Jogos;20070711;0000000044.29;;#######################################################################################################################################################################################00000002;Catorze Minutos;Antonio Luis;Annapurr;20210819;0000000051.99;;#########################################################################################################################################################################################00000003;Esquerda 4 Morto 2;Valvula;Valvula;20091117;0000000020.69;;############################################################################################################################################################################################00000004;Cavaleiro Vazio;Time Cereja;Time Cereja;20170224;0000000027.99;Metroidvania;###########################################################################################################################################################################00000005;Katana -1;Askiihard;Retornar Analogo;20190418;0000000028.99;;##########################################################################################################################################################################################00000006;Overtale;Tobias Raposa;Tobias Raposa;20190418;0000000019.99;;##########################################################################################################################################################################################00000007;Pluto;Supertiny Games;Supertiny Games;20200917;0000000047.49;;#########################################################################################################################################################################################00000008;After Your Eyes;HelloWorld Games;Groundbound Games;20210408;0000000020.69;;############################################################################################################################################################################
\echo index categorias_secundario_idx
FPS, 0
Metroidvania, 1
\echo index categorias_primario_idx
00000000, -1
00000004, -1

UPDATE jogos SET categorias = array_append(categorias, 'Plataforma') WHERE titulo = 'Cavaleiro Vazio';
OK
\echo file ARQUIVO_JOGOS
00000000;Meia-Vida;Valvula;Valvula;19981119;0000000029.69;FPS;##################################################################################################################################################################################################00000001;Presa;Cabeca de Melao Studios;40K Jogos;20070711;0000000044.29;;#######################################################################################################################################################################################00000002;Catorze Minutos;Antonio Luis;Annapurr;20210819;0000000051.99;;#########################################################################################################################################################################################00000003;Esquerda 4 Morto 2;Valvula;Valvula;20091117;0000000020.69;;############################################################################################################################################################################################00000004;Cavaleiro Vazio;Time Cereja;Time Cereja;20170224;0000000027.99;Metroidvania|Plataforma;################################################################################################################################################################00000005;Katana -1;Askiihard;Retornar Analogo;20190418;0000000028.99;;##########################################################################################################################################################################################00000006;Overtale;Tobias Raposa;Tobias Raposa;20190418;0000000019.99;;##########################################################################################################################################################################################00000007;Pluto;Supertiny Games;Supertiny Games;20200917;0000000047.49;;#########################################################################################################################################################################################00000008;After Your Eyes;HelloWorld Games;Groundbound Games;20210408;0000000020.69;;############################################################################################################################################################################
\echo index categorias_secundario_idx
FPS, 0
Metroidvania, 1
Plataforma, 2
\echo index categorias_primario_idx
00000000, -1
00000004, -1
00000004, -1

UPDATE jogos SET categorias = array_append(categorias, 'Acao') WHERE titulo = 'Cavaleiro Vazio';
OK
\echo file ARQUIVO_JOGOS
00000000;Meia-Vida;Valvula;Valvula;19981119;0000000029.69;FPS;##################################################################################################################################################################################################00000001;Presa;Cabeca de Melao Studios;40K Jogos;20070711;0000000044.29;;#######################################################################################################################################################################################00000002;Catorze Minutos;Antonio Luis;Annapurr;20210819;0000000051.99;;#########################################################################################################################################################################################00000003;Esquerda 4 Morto 2;Valvula;Valvula;20091117;0000000020.69;;############################################################################################################################################################################################00000004;Cavaleiro Vazio;Time Cereja;Time Cereja;20170224;0000000027.99;Metroidvania|Plataforma|Acao;###########################################################################################################################################################00000005;Katana -1;Askiihard;Retornar Analogo;20190418;0000000028.99;;##########################################################################################################################################################################################00000006;Overtale;Tobias Raposa;Tobias Raposa;20190418;0000000019.99;;##########################################################################################################################################################################################00000007;Pluto;Supertiny Games;Supertiny Games;20200917;0000000047.49;;#########################################################################################################################################################################################00000008;After Your Eyes;HelloWorld Games;Groundbound Games;20210408;0000000020.69;;############################################################################################################################################################################
\echo index categorias_secundario_idx
Acao, 3
FPS, 0
Metroidvania, 1
Plataforma, 2
\echo index categorias_primario_idx
00000000, -1
00000004, -1
00000004, -1
00000004, -1

UPDATE jogos SET categorias = array_append(categorias, 'FPS') WHERE titulo = 'Esquerda 4 Morto 2';
OK
\echo file ARQUIVO_JOGOS
00000000;Meia-Vida;Valvula;Valvula;19981119;0000000029.69;FPS;##################################################################################################################################################################################################00000001;Presa;Cabeca de Melao Studios;40K Jogos;20070711;0000000044.29;;#######################################################################################################################################################################################00000002;Catorze Minutos;Antonio Luis;Annapurr;20210819;0000000051.99;;#########################################################################################################################################################################################00000003;Esquerda 4 Morto 2;Valvula;Valvula;20091117;0000000020.69;FPS;#########################################################################################################################################################################################00000004;Cavaleiro Vazio;Time Cereja;Time Cereja;20170224;0000000027.99;Metroidvania|Plataforma|Acao;###########################################################################################################################################################00000005;Katana -1;Askiihard;Retornar Analogo;20190418;0000000028.99;;##########################################################################################################################################################################################00000006;Overtale;Tobias Raposa;Tobias Raposa;20190418;0000000019.99;;##########################################################################################################################################################################################00000007;Pluto;Supertiny Games;Supertiny Games;20200917;0000000047.49;;#########################################################################################################################################################################################00000008;After Your Eyes;HelloWorld Games;Groundbound Games;20210408;0000000020.69;;############################################################################################################################################################################
\echo index categorias_secundario_idx
Acao, 3
FPS, 0
Metroidvania, 1
Plataforma, 2
\echo index categorias_primario_idx
00000000, 4
00000004, -1
00000004, -1
00000004, -1
00000003, -1

UPDATE jogos SET categorias = array_append(categorias, 'Acao') WHERE titulo = 'Pluto';
OK
\echo file ARQUIVO_JOGOS
00000000;Meia-Vida;Valvula;Valvula;19981119;0000000029.69;FPS;##################################################################################################################################################################################################00000001;Presa;Cabeca de Melao Studios;40K Jogos;20070711;0000000044.29;;#######################################################################################################################################################################################00000002;Catorze Minutos;Antonio Luis;Annapurr;20210819;0000000051.99;;#########################################################################################################################################################################################00000003;Esquerda 4 Morto 2;Valvula;Valvula;20091117;0000000020.69;FPS;#########################################################################################################################################################################################00000004;Cavaleiro Vazio;Time Cereja;Time Cereja;20170224;0000000027.99;Metroidvania|Plataforma|Acao;###########################################################################################################################################################00000005;Katana -1;Askiihard;Retornar Analogo;20190418;0000000028.99;;##########################################################################################################################################################################################00000006;Overtale;Tobias Raposa;Tobias Raposa;20190418;0000000019.99;;##########################################################################################################################################################################################00000007;Pluto;Supertiny Games;Supertiny Games;20200917;0000000047.49;Acao;#####################################################################################################################################################################################00000008;After Your Eyes;HelloWorld Games;Groundbound Games;20210408;0000000020.69;;############################################################################################################################################################################
\echo index categorias_secundario_idx
Acao, 3
FPS, 0
Metroidvania, 1
Plataforma, 2
\echo index categorias_primario_idx
00000000, 4
00000004, -1
00000004, -1
00000004, 5
00000003, -1
00000007, -1

UPDATE jogos SET categorias = array_append(categorias, 'Acao') WHERE titulo = 'Katana -1';
OK
\echo file ARQUIVO_JOGOS
00000000;Meia-Vida;Valvula;Valvula;19981119;0000000029.69;FPS;##################################################################################################################################################################################################00000001;Presa;Cabeca de Melao Studios;40K Jogos;20070711;0000000044.29;;#######################################################################################################################################################################################00000002;Catorze Minutos;Antonio Luis;Annapurr;20210819;0000000051.99;;#########################################################################################################################################################################################00000003;Esquerda 4 Morto 2;Valvula;Valvula;20091117;0000000020.69;FPS;#########################################################################################################################################################################################00000004;Cavaleiro Vazio;Time Cereja;Time Cereja;20170224;0000000027.99;Metroidvania|Plataforma|Acao;###########################################################################################################################################################00000005;Katana -1;Askiihard;Retornar Analogo;20190418;0000000028.99;Acao;######################################################################################################################################################################################00000006;Overtale;Tobias Raposa;Tobias Raposa;20190418;0000000019.99;;##########################################################################################################################################################################################00000007;Pluto;Supertiny Games;Supertiny Games;20200917;0000000047.49;Acao;#####################################################################################################################################################################################00000008;After Your Eyes;HelloWorld Games;Groundbound Games;20210408;0000000020.69;;############################################################################################################################################################################
\echo index categorias_secundario_idx
Acao, 3
FPS, 0
Metroidvania, 1
Plataforma, 2
\echo index categorias_primario_idx
00000000, 4
00000004, -1
00000004, -1
00000004, 5
00000003, -1
00000007, 6
00000005, -1

UPDATE jogos SET categorias = array_append(categorias, 'Plataforma') WHERE titulo = 'Katana -1';
OK
\echo file ARQUIVO_JOGOS
00000000;Meia-Vida;Valvula;Valvula;19981119;0000000029.69;FPS;##################################################################################################################################################################################################00000001;Presa;Cabeca de Melao Studios;40K Jogos;20070711;0000000044.29;;#######################################################################################################################################################################################00000002;Catorze Minutos;Antonio Luis;Annapurr;20210819;0000000051.99;;#########################################################################################################################################################################################00000003;Esquerda 4 Morto 2;Valvula;Valvula;20091117;0000000020.69;FPS;#########################################################################################################################################################################################00000004;Cavaleiro Vazio;Time Cereja;Time Cereja;20170224;0000000027.99;Metroidvania|Plataforma|Acao;###########################################################################################################################################################00000005;Katana -1;Askiihard;Retornar Analogo;20190418;0000000028.99;Acao|Plataforma;###########################################################################################################################################################################00000006;Overtale;Tobias Raposa;Tobias Raposa;20190418;0000000019.99;;##########################################################################################################################################################################################00000007;Pluto;Supertiny Games;Supertiny Games;20200917;0000000047.49;Acao;#####################################################################################################################################################################################00000008;After Your Eyes;HelloWorld Games;Groundbound Games;20210408;0000000020.69;;############################################################################################################################################################################
\echo index categorias_secundario_idx
Acao, 3
FPS, 0
Metroidvania, 1
Plataforma, 2
\echo index categorias_primario_idx
00000000, 4
00000004, -1
00000004, 7
00000004, 5
00000003, -1
00000007, 6
00000005, -1
00000005, -1

-- cadastrar categorias para jogos inexistentes
UPDATE jogos SET categorias = array_append(categorias, 'Esporte') WHERE titulo = 'PES 2077';
ERRO: Registro nao encontrado
UPDATE jogos SET categorias = array_append(categorias, 'Cooperativo') WHERE titulo = 'Queimei o Fogao e Ele Caiu Socorro';
ERRO: Registro nao encontrado
UPDATE jogos SET categorias = array_append(categorias, 'Simulacao') WHERE titulo = 'AsiaTruck Simulator';
ERRO: Registro nao encontrado

\echo file ARQUIVO_JOGOS
00000000;Meia-Vida;Valvula;Valvula;19981119;0000000029.69;FPS;##################################################################################################################################################################################################00000001;Presa;Cabeca de Melao Studios;40K Jogos;20070711;0000000044.29;;#######################################################################################################################################################################################00000002;Catorze Minutos;Antonio Luis;Annapurr;20210819;0000000051.99;;#########################################################################################################################################################################################00000003;Esquerda 4 Morto 2;Valvula;Valvula;20091117;0000000020.69;FPS;#########################################################################################################################################################################################00000004;Cavaleiro Vazio;Time Cereja;Time Cereja;20170224;0000000027.99;Metroidvania|Plataforma|Acao;###########################################################################################################################################################00000005;Katana -1;Askiihard;Retornar Analogo;20190418;0000000028.99;Acao|Plataforma;###########################################################################################################################################################################00000006;Overtale;Tobias Raposa;Tobias Raposa;20190418;0000000019.99;;##########################################################################################################################################################################################00000007;Pluto;Supertiny Games;Supertiny Games;20200917;0000000047.49;Acao;#####################################################################################################################################################################################00000008;After Your Eyes;HelloWorld Games;Groundbound Games;20210408;0000000020.69;;############################################################################################################################################################################
\echo index categorias_secundario_idx
Acao, 3
FPS, 0
Metroidvania, 1
Plataforma, 2
\echo index categorias_primario_idx
00000000, 4
00000004, -1
00000004, 7
00000004, 5
00000003, -1
00000007, 6
00000005, -1
00000005, -1

-- cadastrar categorias repetidas
UPDATE jogos SET categorias = array_append(categorias, 'FPS') WHERE titulo = 'Meia-Vida';
ERRO: O jogo Meia-Vida ja possui a categoria FPS
UPDATE jogos SET categorias = array_append(categorias, 'Metroidvania') WHERE titulo = 'Cavaleiro Vazio';
ERRO: O jogo Cavaleiro Vazio ja possui a categoria Metroidvania

\echo file ARQUIVO_JOGOS
00000000;Meia-Vida;Valvula;Valvula;19981119;0000000029.69;FPS;##################################################################################################################################################################################################00000001;Presa;Cabeca de Melao Studios;40K Jogos;20070711;0000000044.29;;#######################################################################################################################################################################################00000002;Catorze Minutos;Antonio Luis;Annapurr;20210819;0000000051.99;;#########################################################################################################################################################################################00000003;Esquerda 4 Morto 2;Valvula;Valvula;20091117;0000000020.69;FPS;#########################################################################################################################################################################################00000004;Cavaleiro Vazio;Time Cereja;Time Cereja;20170224;0000000027.99;Metroidvania|Plataforma|Acao;###########################################################################################################################################################00000005;Katana -1;Askiihard;Retornar Analogo;20190418;0000000028.99;Acao|Plataforma;###########################################################################################################################################################################00000006;Overtale;Tobias Raposa;Tobias Raposa;20190418;0000000019.99;;##########################################################################################################################################################################################00000007;Pluto;Supertiny Games;Supertiny Games;20200917;0000000047.49;Acao;#####################################################################################################################################################################################00000008;After Your Eyes;HelloWorld Games;Groundbound Games;20210408;0000000020.69;;############################################################################################################################################################################
\echo index categorias_secundario_idx
Acao, 3
FPS, 0
Metroidvania, 1
Plataforma, 2
\echo index categorias_primario_idx
00000000, 4
00000004, -1
00000004, 7
00000004, 5
00000003, -1
00000007, 6
00000005, -1
00000005, -1

-- listar jogos de certa categoria
SELECT * FROM jogos WHERE 'FPS' = ANY (categorias) ORDER BY id_game ASC;
Registros percorridos: 0 4
00000000, Meia-Vida, Valvula, Valvula, 19981119, 29.69
00000003, Esquerda 4 Morto 2, Valvula, Valvula, 20091117, 20.69

SELECT * FROM jogos WHERE 'Plataforma' = ANY (categorias) ORDER BY id_game ASC;
Registros percorridos: 2 7
00000004, Cavaleiro Vazio, Time Cereja, Time Cereja, 20170224, 27.99
00000005, Katana -1, Askiihard, Retornar Analogo, 20190418, 28.99

SELECT * FROM jogos WHERE 'Acao' = ANY (categorias) ORDER BY id_game ASC;
Registros percorridos: 3 5 6
00000004, Cavaleiro Vazio, Time Cereja, Time Cereja, 20170224, 27.99
00000005, Katana -1, Askiihard, Retornar Analogo, 20190418, 28.99
00000007, Pluto, Supertiny Games, Supertiny Games, 20200917, 47.49

SELECT * FROM jogos WHERE 'Metroidvania' = ANY (categorias) ORDER BY id_game ASC;
Registros percorridos: 1
00000004, Cavaleiro Vazio, Time Cereja, Time Cereja, 20170224, 27.99

SELECT * FROM jogos WHERE 'Simulacao' = ANY (categorias) ORDER BY id_game ASC;
AVISO: Nenhum registro encontrado

\q
